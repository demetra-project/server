<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demetra Server</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div id="container">
    <h1>Queries and Mutations for Sensors and Objects Data</h1>

  <script>
    const queries = [
      {
        'name': 'allSensorData',
        'title': 'To fetch all sensors data',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"{ allSensorData { temperature humidity gas gps_lat gps_lon created_at } }"}\''
      },
      {
        'name': 'sensorData',
        'title': 'To fetch a sensor data',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"{ sensorData(gps_lat:45.1234, gps_lon:9.1234, created_at:\"2025-04-24T00:00:00.000Z\") { temperature humidity gas gps_lat gps_lon created_at } }"}\''
      },
      {
        'name': 'allRecognitions',
        'title': 'To fetch all recognized objects',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"{ allRecognitions { id object_name object_quantity gps_lat gps_lon sensor_created_at created_at } }"}\''
      },
      {
        'name': 'recognition',
        'title': 'To fetch an object',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"{ recognition(gps_lat:45.1234, gps_lon:9.1234, created_at:\"2025-04-24T00:00:00.000Z\") { id object_name object_quantity gps_lat gps_lon sensor_created_at created_at } }"}\'\''
      }
    ]

    mutations = [
      {
        'name': 'addSensorData',
        'title': 'To add a sensors data acquisition',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"mutation { addSensorData(temperature:23.5, humidity:45.2, gas:0.9, gps_lat:45.1234, gps_lon:9.1234, created_at:\"2025-04-24T00:00:00.000Z\") { temperature humidity gas gps_lat gps_lon created_at } }"}\''
      },
      {
        'name': 'addObject',
        'title': 'to add a new recognized object',
        'query': 'curl -X POST http://localhost:4000/“ -H "Content-Type: application/json" -d \'{"query":"mutation { addObject(object_name:\"Bottiglia\", object_quantity:2, gps_lat:45.1234, gps_lon:9.1234, sensor_created_at:\"2025-04-24T00:00:00.000Z\", created_at:\"2025-04-24T00:01:00.000Z\") { id object_name object_quantity gps_lat gps_lon sensor_created_at created_at } }"}\''
      }
    ]

    function copyToClipboard(id, button) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => {
        button.disabled = true;
        button.textContent = 'Copied';
        setTimeout(() => { button.textContent = 'Copy'; button.disabled = false; }, 1500);
      }).catch(err => console.error('Copy failed:', err));
    }

    createCard = (query) => {
      const queryDiv = document.createElement('div');
      const header = document.createElement('h2');
      const codeBlock = document.createElement('div');
      const copyButton = document.createElement('button');
      const preElement = document.createElement('pre');

      queryDiv.classList.add('query');
      header.textContent = query.title;
      queryDiv.appendChild(header);
      codeBlock.classList.add('code-block');
      copyButton.classList.add('copy-btn');
      copyButton.textContent = 'Copy';
      copyButton.addEventListener('click', function() {
        copyToClipboard(query.name, copyButton);
      });
      codeBlock.appendChild(copyButton);
      preElement.id = query.name;
      preElement.textContent = query.query;

      codeBlock.appendChild(preElement);
      queryDiv.appendChild(codeBlock);
      container.appendChild(queryDiv);
    }

    queries.forEach(query => { createCard(query) });
    mutations.forEach(query => { createCard(query) });
  </script>

</body>
</html>